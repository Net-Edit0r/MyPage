
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Cyber Security Research</title>
  <meta name="author" content="Net.Edit0r">

  
  <meta name="description" content="Is everyone using this add-on at risk? It really depends, as vBulletin is a highly configurable piece of software, you may or may not be directly &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://nasirpour.info/blog">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Cyber Security Research" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <meta name="author" content="Net.Edit0r">

<meta name="description" content="Dariush Nasirpour Resume/CV Personal Informaion • Cyber Security Research">
<meta name="keywords" content="security, malware, vulnerability, net.edit0r, analysis, iranian hacker, dariush nasirpour, hacking, report, exploit, deface, cyber security,"> 

<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet" type="text/css">
<!--- MathJax Configuration -->
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

</head>

<body   class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Cyber Security Research</a></h1>
  
    <h2>Official Website Dariush Nasirpour.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscribe" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 13.310204,73.332654 C 5.967347,73.332654 0,79.322448 0,86.621428 c 0,7.338776 5.967347,13.262246 13.310204,13.262246 7.370408,0 13.328572,-5.92245 13.328572,-13.262246 0,-7.29898 -5.958164,-13.288774 -13.328572,-13.288774 z M 0.01530612,33.978572 V 53.143878 C 12.493878,53.143878 24.229592,58.02347 33.068368,66.865306 41.894898,75.685714 46.767346,87.47449 46.767346,100 h 19.25 C 66.017346,63.592858 36.4,33.979592 0.01530612,33.978572 l 0,0 z M 0.03877552,0 V 19.17449 C 44.54796,19.17551 80.77551,55.437756 80.77551,100 H 100 C 100,44.87653 55.15102,0 0.03877552,0 z"></path></svg></a></li>
  
</ul>
  
  
  
  
  
<ul class="subscribe">
  <li><a href="https://github.com/Net-Edit0r" rel="subscribe-github" title="@Net-Edit0r on GitHub"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewbox="0 0 100 100"><path class="social" d="M 50,0 C 22.385714,0 0,22.385714 0,50 0,77.614286 22.385714,100 50,100 77.614286,100 100,77.614286 100,50 100,22.385714 77.614286,0 50,0 z m 29.692858,79.692858 c -3.859184,3.859182 -8.351022,6.887754 -13.35,9.00306 -1.27041,0.536736 -2.560204,1.009184 -3.867348,1.415306 v -7.493878 c 0,-3.938774 -1.35102,-6.835714 -4.053062,-8.690816 1.692858,-0.163264 3.24694,-0.390816 4.663266,-0.683672 1.416326,-0.292858 2.913266,-0.716328 4.491838,-1.27041 1.57857,-0.55408 2.994896,-1.213264 4.247958,-1.97755 1.253062,-0.765306 2.458164,-1.758164 3.613266,-2.978572 1.155102,-1.220408 2.12449,-2.604082 2.905102,-4.15 0.780612,-1.545918 1.4,-3.40204 1.855102,-5.566326 0.455102,-2.164286 0.683674,-4.54898 0.683674,-7.153062 0,-5.045918 -1.643878,-9.341836 -4.931634,-12.890816 C 77.44796,33.35 77.285714,29.10204 75.463266,24.512244 l -1.22143,-0.145918 c -0.845918,-0.09796 -2.368366,0.260204 -4.565306,1.07449 -2.196938,0.814286 -4.663264,2.14796 -7.396938,4.004082 -3.87449,-1.07449 -7.893878,-1.611224 -12.061224,-1.611224 -4.19898,0 -8.203062,0.536734 -12.012246,1.611224 -1.72449,-1.17245 -3.361224,-2.139796 -4.907142,-2.905102 C 31.753062,25.77449 30.516326,25.254082 29.587756,24.97653 28.660204,24.7 27.79796,24.528572 27,24.463266 c -0.79796,-0.0653 -1.310204,-0.08062 -1.537756,-0.04898 -0.22755,0.03164 -0.390816,0.0653 -0.487754,0.09796 -1.82347,4.62245 -1.985714,8.87143 -0.487756,12.743878 -3.287754,3.54796 -4.931632,7.844898 -4.931632,12.890816 0,2.604082 0.227552,4.988776 0.683674,7.153062 0.456122,2.164286 1.07449,4.020408 1.855102,5.566326 0.780612,1.545918 1.75,2.929592 2.905102,4.15 1.155102,1.220408 2.360204,2.213266 3.613264,2.978572 1.253062,0.766326 2.669388,1.42449 4.24796,1.97755 1.578572,0.554082 3.07551,0.976532 4.491836,1.27041 1.416328,0.292856 2.970408,0.521428 4.663266,0.683672 -2.669388,1.82347 -4.004082,4.720408 -4.004082,8.690816 v 7.639796 C 36.536734,89.818368 35.083674,89.3 33.656122,88.695918 c -4.99898,-2.115306 -9.490816,-5.143878 -13.35,-9.00306 -3.859184,-3.859184 -6.887754,-8.351022 -9.00306,-13.35 C 9.1163263,61.171428 8.0071428,55.67347 8.0071428,50 c 0,-5.67347 1.1091835,-11.171428 3.2969392,-16.342858 2.115306,-4.998978 5.143878,-9.490816 9.00306,-13.35 3.859184,-3.859182 8.351022,-6.887754 13.35,-9.00306 C 38.828572,9.1163266 44.32653,8.0071428 50,8.0071428 c 5.67347,0 11.171428,1.1091838 16.342858,3.2969392 5,2.115306 9.490816,5.143878 13.35,9.00306 3.859182,3.859184 6.887754,8.351022 9.00306,13.35 2.186736,5.17245 3.295918,10.67041 3.295918,16.342858 0,5.672448 -1.109182,11.171428 -3.296938,16.342858 -2.115306,4.998978 -5.143878,9.490816 -9.00204,13.35 l 0,0 z"></path></svg></a></li>
</ul>
  
  
  
<ul class="subscribe">
  <li><a href="https://twitter.com/NetEdit0r" rel="subscribe-twitter" title="@NetEdit0r on Twitter"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="25" height="25" viewBox="0 0 512 512"><path class="social" d="M0.001,334.932c33.327,30.816,118.891,59.981,188.517-8.271c-12.52,1.955-22.972-0.416-30.913-8.269
  c-7.531-7.465-7.945-15.182-3.914-22.202c3.275-5.725,10.184-9.741,16.977-13.934c-12.323,2.285-22.829,1.095-32.218-3.706
  c-12.604-6.444-24.863-13.228-28.3-27.207c7.71-8.112,16.28-15.359,34.831-12.627c-17.45-5.83-33.087-13.429-44.41-24.815
  c-11.028-11.091-12.163-18.302-13.932-26.996c9.632-3.567,19.688-5.421,30.478-4.353c-24.397-12.476-34.757-29.63-40.487-48.325
  c-1.731-5.652-2.044-11.03-1.31-16.545c98.826,37.305,145.11,64.109,170.662,89.251c11.496-30.589,38.3-99.868,78.371-123.646
  c0.191,3.77-1.309,7.837-4.357,12.189c11.863-6.609,21.125-17.188,37.445-16.98c-1.879,7.723-7.279,13.904-17.85,17.854
  c10.662-4.084,21.463-7.545,32.65-9.578c10.375-1.881,10.229,6.304,4.355,10.444c-11.916,8.412-24.578,9.456-37.006,13.498
  c38.105,0.949,69.266,18.994,93.604,58.343c8.088,13.074,13.52,26.149,14.807,40.487c16.254,4.563,32.426,5.494,48.76,2.61
  c4.475-0.796,8.645-1.63,12.627-3.482c-6.354,9.529-13.686,17.356-23.947,20.899c-9.811,3.387-19.637,6.688-30.473,6.968
  c17.641,6.675,37.082,7.045,57.033,5.659c-24.402,23.486-43.08,22.922-61.824,22.642c-8.221,34.703-25.025,69.315-60.52,101.005
  c-46.559,41.569-96.678,61.397-148.457,65.742c-48.552,4.07-95.488,3.512-146.726-20.464
  C56.486,393.349,24.648,368.884,0.001,334.932L0.001,334.932z"/></svg></a></li>
</ul>
  
  
  
  
<ul class="main-navigation">
  <li><a href="/">About</a></li>
  <li><a href="/writing/">Writing</a></li>
  <li><a href="/resume/">Resume / CV</a></li>
  <li><a href="/blog/">Bloggery</a></li>
</ul>


</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
   <article>
      
  <header>
    
      <h1 class="entry-title"><a href="#">Bypass Cloudflare To Get Real IP Address</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-01-29T00:00:00-02:00'><span class='date'><span class='date-month'>January</span> <span class='date-day'>29</span><span class='date-suffix'>rd</span>, <span class='date-year'>2016</span></span> <span class='time'>12:41 am</span></time>        
        
      </p>
    
  </header>


  <div class="entry-content"><h3>What is CloudFlare</h3>


<p>CloudFlare is one of the fastest growing CDN providers, which has free and premium service to accelerate, optimize & secure websites.

There are more than 2,000,000 web properties powered by CloudFlare and I use their service too.

If you are already using CloudFlare then you might have noticed IP address in DNS lookup get reflected with CloudFlare.</p>

<h3>Example of Disqus PHP Comment Spamming Tool</h3>

<p></p><pre><code class="hljs-tag">
'''
    File name: Bypass Cloudflare To Get Real IP Address
    Author: Dariush Nasirpour (Net.Edit0r)
    Date created: 19/11/2018
    Web: http://nasirpour.info
    Spicial Thanks to Ehsan Nezami
'''

import socket

socket.setdefaulttimeout(1)

domain = raw_input("Enter your domain: ")

try:
	print "Starting...\n\r"
	dns=["ns1.","ns2.","ns3.","ns4.","primary.","host1.","host2.","masterdns.","slavedns.","dns1.","dns2.","master.","slave.","node1.","node2."]
	for dns_name in dns:
		remoteServerIP=dns_name+domain
		for port in [53,80]:
			try:
				sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
				IP = socket.gethostbyname(remoteServerIP)
				result = sock.connect_ex((remoteServerIP, port))
				if result == 0:
					print "[+] Open\t{:<50}{:<3}\t{}".format(remoteServerIP,port,IP)
				sock.close()
			except socket.gaierror:
				print '[-] Hostname could not be resolved.'
				pass
			except socket.error:
				print "[-] Couldn't connect to server"
				pass
	print "\n[*] Finished!"
except KeyboardInterrupt:
	print "You pressed Ctrl+C"
	pass

</code></pre>
  


    </article> 
  
  <article>
      
  <header>
    
      <h1 class="entry-title"><a href="#">Disqus Comment Spamming Tool</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-01-29T00:00:00-02:00'><span class='date'><span class='date-month'>January</span> <span class='date-day'>29</span><span class='date-suffix'>rd</span>, <span class='date-year'>2016</span></span> <span class='time'>12:41 am</span></time>        
        
      </p>
    
  </header>


  <div class="entry-content"><h3>What is Comment Spamming</h3>


<p>Comment spam is a term used by spam blacklist servers such as Project Honey Pot to refer to a broad category of spambot or spammer postings which abuse web-based forms to post unsolicited advertisements as comments on forums, blogs, wikis and online guestbooks.</p>

<h3>Example of Disqus PHP Comment Spamming Tool</h3>

<p></p><pre><code class="hljs-tag">&lt;?php
#Coded by Dariush Nasirpour #Net.Edit0r
#My website: Black-hg.org or nasirpour.info
$loppping = 1;
while ($loppping &lt;= 10000) {  
$massagearray = array("Massage1", "Massage2", "Massage3", "Massage4");

foreach ($massagearray as $massage) {
    $spam = curl_init();                 
    $url = "https://disqus.com/api/3.0/posts/create.json"; 
        $headers = array();
        $headers[] = 'Host: disqus.com';
        $headers[] = 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8';
        $headers[] = 'Accept-Language: en-US,en;q=0.5';
        $headers[] = 'Accept-Encoding: gzip, deflate';
        $headers[] = 'Content-Type: application/x-www-form-urlencoded; spamarset=UTF-8';
        $headers[] = 'X-Requested-With: XMLHttpRequest';
        $headers[] = 'User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0';
        $headers[] = 'Cookie: disqus_unique=2kglrci2vmt7ni; __utma=40641725.1273496447.1425738106.1425738106.1425738106.1; __utmz=40641725.1425738106.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmc=40641725; _cb_ls=1; _spamartbeat2=Ca4V9aZC4VmeKd08.1425725115637.1425737960160.1; csrftoken=iXhUjuMFqXbp7MQHBjjKZ6Al528DU2It; mp_17b27902cd9da8972af8a3c43850fa5f_mixpanel=%7B%22distinct_id%22%3A%20%2214bf3d71a7d60b-01b0e9919c5afc8-45574336-15f900-14bf3d71a7e586%22%7D; sessionid=7e9ece6e-c4cd-11e4-8ac9-002590f30436; __jid=59vjl1a1hi25fc; __utmb=40641725.3.9.1425738314944; disqusauth="1|dariushnasirpour|0|1|0||147368477|//a.disquscdn.com/1425664697/images/noavatar32.png|1"; mp_3ad8df9f28f928f3f970501b99cc717c_mixpanel=%7B%22distinct_id%22%3A%20%2214bf3d681ba99-0ec07c875f63e3-45574336-15f900-14bf3d681bb302%22%2C%22%24initial_referrer%22%3A%20%22%24direct%22%2C%22%24initial_referring_domain%22%3A%20%22%24direct%22%7D; _spamartbeat4=t=BXPlGvsmdfUD3EvGuDIaRHfCb6kCq&E=0&x=0&c=0.01&y=1281&w=481';
    curl_setopt($spam, CURLOPT_HTTPHEADER, $headers);
    curl_setopt($spam, CURLOPT_URL,$url);
    curl_setopt($spam, CURLOPT_POST, true);
    curl_setopt($spam, CURLOPT_POSTFIELDS, "thread=3575197749&message=$massage&api_key=E8Uh5l5fHZ6gD8U3KycjAIAk46f68Zw7C6eW8WSjZvCLXebZ7p0r1yrYDrLilk2F");
    curl_setopt($spam, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($spam, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($spam, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($spam, CURLOPT_HEADER, 1);
    $output = curl_exec ($spam);
    curl_close ($spam); 
    var_dump($output);
    }
}
?&gt; 
</code></pre>
  


    </article>
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/vbulletin-vbseo-4-dot-x-x-vulnerability-leads-to-remote-code-execution/">Reported vBulletin vBSEO 4.x Vulnerability - CVE-2014-9463</a></h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-03-03T00:00:00-05:00'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2015</span></span> <span class='time'>12:00 am</span></time>
        
         | <a href="/blog/vbulletin-vbseo-4-dot-x-x-vulnerability-leads-to-remote-code-execution/#disqus_thread">Comments</a>
        
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Is everyone using this add-on at risk?</h3>


<p>It really depends, as vBulletin is a highly configurable piece of software, you may or may not be directly affected.
The vulnerable snippet of code executes upon loading vBulletin’s memberinfo_visitormessage template. That means that if you allow your visitors (authenticated or not) to leave and see the “visitor messages” section of a user’s profile, you’re at risk.</p>

<h3>Technical details</h3>


<p>For some reasons, vBSEO will insert user-provided referer link into the visitormessage template:</p>

<p><img src="http://nasirpour.info/file/other/vuln/vBSEO-vb.png"></p>

<p>As you can see at lines 653 and 658, it does so by passing the $permalinkurl variable to the vbseo_modify_template34() function, which by itself doesn’t look that bad, beside presenting an obvious XSS vulnerability (the variable is not sanitized before being put in there).</p>

<p>That said, things gets a little bit uglier when having a look at vbseo_modify_template34()‘s code:</p>

<p><img src="http://nasirpour.info/file/other/vuln/vBSEO-I2.png"></p>

<p>At first glance, we can tell that these preg_replace() calls aren’t anything good, particularly for us as an attacker can control $replacewith‘s content – with which he could craft a payload that matches any of these regular expressions to insert what looks like PHP code in the template!</p>

<p>We could confirm our thought by analysing the vbseo_modify_template() function which essentially just replaces the specified snippet of code in vBulletin’s template cache.
So, to inject PHP code, an attacker would have to insert something like this in the referrer field (making it very easy to flag by looking at your HTTP server’s logs):</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/vbulletin-vbseo-4-dot-x-x-vulnerability-leads-to-remote-code-execution/">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy;2014-2015 - Net.Edit0r -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'nasirpour';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
